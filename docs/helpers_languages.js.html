<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>helpers/languages.js - SquadStatJSPRO</title>
    
    <meta name="description" content="Discord bot and website statistics for your game server (Squad)" />
    
        <meta name="keywords" content="squad, squadjs, stats, leaderboard, discord, website" />
        <meta name="keyword" content="squad, squadjs, stats, leaderboard, discord, website" />
    
    
    
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    
    <meta property="og:url" content=""/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav class="wrap">
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/11TStudio/SquadStatsJSPRO" target="_blank" class="menu-item" id="website_link" >Project Website</a></h2><h2><a href="https://discord.gg/9F2Ng5C" target="_blank" class="menu-item" id="discord_link" >Discord</a></h2><h3>Classes</h3><ul><li><a href="MYSQLPromiseObjectBuilder.html">MYSQLPromiseObjectBuilder</a><ul class='methods'><li data-type='method' style='display: none;'><a href="MYSQLPromiseObjectBuilder.html#add">add</a></li><li data-type='method' style='display: none;'><a href="MYSQLPromiseObjectBuilder.html#waitForAll">waitForAll</a></li></ul></li><li><a href="Squad-Configure-Connection.html">Squad-Configure-Connection</a></li><li><a href="Squad-Track-Profile.html">Squad-Track-Profile</a></li></ul><h3>Global</h3><ul><li><a href="global.html#dateTimePad">dateTimePad</a></li><li><a href="global.html#format">format</a></li><li><a href="global.html#walkDirectory">walkDirectory</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">helpers/languages.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const i18next = require("i18next");
const Backend = require("i18next-node-fs-backend");
const path = require("path");
const fs = require("fs").promises;

/**.
 * Reads the contents of an directory, walks inside the directory
 *
 * @param {*} dir - the locations
 * @param {*}namespaces - the namespaces if any
 * @param {*} folderName - the folder names if any
 * @returns {*} return an set of found folders with languages
 */
async function walkDirectory(dir, namespaces = [], folderName = "") {
	const files = await fs.readdir(dir);

	const languages = [];
	for (const file of files) {
		const stat = await fs.stat(path.join(dir, file));
		if (stat.isDirectory()) {
			const isLanguage = file.includes("-");
			if (isLanguage) languages.push(file);

			const folder = await walkDirectory(
				path.join(dir, file),
				namespaces,
				isLanguage ? "" : `${file}/`
			);

			namespaces = folder.namespaces;
		} else {
			namespaces.push(`${folderName}${file.substr(0, file.length - 5)}`);
		}
	}

	return { namespaces: [...new Set(namespaces)], languages };
}

module.exports = async () => {
	const options = {
		jsonIndent: 2,
		loadPath: path.resolve(__dirname, "../languages/{{lng}}/{{ns}}.json"),
	};

	const { namespaces, languages } = await walkDirectory(
		path.resolve(__dirname, "../languages/")
	);

	i18next.use(Backend);

	await i18next.init({
		backend: options,
		debug: false,
		fallbackLng: "en-US",
		initImmediate: false,
		interpolation: { escapeValue: false },
		load: "all",
		ns: namespaces,
		preload: languages,
	});

	return new Map(languages.map((item) => [item, i18next.getFixedT(item)]));
};
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.6</a> on Sat Apr 17 2021 15:31:25 GMT+0200 (Orta Avrupa Yaz Saati) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
